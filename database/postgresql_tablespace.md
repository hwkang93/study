# PostgreSQL 에서의 TableSpace

Tablespace 는 일부 DB 에서 등장하는 개념이다. 오라클과 PostgreSQL 에서만 사용되고 MySQL 과 MS-SQL 같은 DBMS 에서는 언급조차 되지 않는 개념이다.

PostgreSQL 에서 DB는 PGDATA 라는 환경변수에 지정된 디렉토리를 통째로 DB로 사용한다. 그리고 그 하위에 테이블이 파일로 생성된다. 
즉 테이블스페이스를 따로 생성하지 않아도 DB에 사용자 테이블을 만들 수 있다. 기본적으로 DB로 지정된 디렉토리 전체가 하나의 기본 테이블스페이스로 인식되는 것이다.

PostgreSQL 공식사이트에서는 다음과 같이 테이블스페이스를 정의하고 있다.

```
포스트그레스-큐엘에서 테이블스페이스는 DB관리자에 의해 데이터베이스의 객체가 저장될 수 있는 파일시스템의 경로로 정의된다. 
테이블스페이스가 생성되면 데이터베이스 객체에 객체를 생성할 때 이름에 의해서 테이블스페이스가 참조될 수 있다.

포스트그레스-큐엘이 설치될 때 디스크레이아웃에 따라 관리자가 생성할 수 있는데 두가지 관점에서 매우 유용하다. 
첫번째는 DB가 생성된 볼륨 또는 파티션에 여유공간이 부족할 때 테이블스페이스를 다른 파티션이나 디스크에 생성하여 시스템을 재구성할 때까지 DB를 확장할 수 있다. 
또 다른 하나는 데이터베이스 객체의 성능 최적화를 위해 사용할 수 있다는 것이다. 
예를 들어 매우 사용량이 많으면서 자주 업데이트 되는 인덱스를 위해 고성능 SSD를 장착하고테이블스페이스를 생성하여 인덱스를 SSD에 생성하여 성능을 개선하는데 사용될 수 있다.
```

만약 물리적으로 다른 경로를 DB에 사용하고자 할 때 테이블스페이스로 지정하여 DB를 확장할 수 있다. 테이블 스페이스는 다음과 같은 DDL 문으로 생성할 수 있으며 해당 테이블스페이스에 태이블을 생성할 수 있다.

```postgresql
CREATE TABLESPACE fastspace LOCATION '/ssd/mydb2/data';

CREATE TABLE emp(empno int, name varchr(12)) TABLESPACE fastspace;
```

DB에 생성되어 있는 테이블스페이스의 정보를 확인하고 싶을 때는 다음의 SQL 문으로 생성되어 있는 테이블스페이스 정보를 확인할 수 있다.

```postgresql
SELECT * FROM pg_tablespace;
```

그리고 PostgreSQL 의 대화형 질의 도구인 psql 을 사용하면 ```\db; ``` 명령으로도 확인할 수 있다.

## Reference

https://blogger.pe.kr/504